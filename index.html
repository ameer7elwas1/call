<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            max-width: 1200px;
            width: 100%;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .login-form {
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
        }

        .main-interface {
            display: none;
        }

        .header {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .tab {
            flex: 1;
            padding: 15px;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            color: #495057;
        }

        .tab.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-2px);
        }

        .tab:hover:not(.active) {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .tab-content.active {
            display: block;
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #495057;
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #6c757d, #495057);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.4);
        }

        .btn-danger {
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.4);
        }

        .btn-success {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .search-results {
            max-height: 400px;
            overflow-y: auto;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            margin-top: 20px;
        }

        .result-item {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .result-item:hover {
            background: #f8f9fa;
            transform: translateX(5px);
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .clock {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .employee-info {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .success-message {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
            display: none;
            animation: slideDown 0.5s ease-out;
        }

        .error-message {
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
            display: none;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-title {
            font-size: 24px;
            font-weight: bold;
            color: #495057;
            margin-bottom: 30px;
            text-align: center;
            position: relative;
        }

        .form-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 3px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 2px;
        }

        .switch-user-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(45deg, #ffc107, #ff8f00);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 5px 15px rgba(255, 193, 7, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .switch-user-btn:hover {
            transform: scale(1.1) rotate(180deg);
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .btn-group {
                justify-content: center;
            }
            
            .clock, .employee-info {
                position: static;
                margin: 10px 0;
                text-align: center;
            }
        }

        .logo {
            width: 60px;
            height: 60px;
            margin: 0 auto 20px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
        <div id="loginForm" class="login-form">
            <div class="logo">ğŸ“</div>
            <h2 class="form-title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
            <div class="form-group">
                <label for="username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</label>
                <input type="text" id="username" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            </div>
            <div class="form-group">
                <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                <input type="password" id="password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
                <button class="btn btn-secondary" onclick="closeApp()">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
            <div id="loginError" class="error-message"></div>
        </div>

        <!-- Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
        <div id="mainInterface" class="main-interface">
            <div class="header">
                <h1>ğŸ¢ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª</h1>
                <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…ØªØ·ÙˆØ±</p>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="showTab('customer-tab')">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</button>
                <button class="tab" onclick="showTab('call-tab')">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª</button>
                <button class="tab" onclick="showTab('search-tab')">Ø§Ù„Ø¨Ø­Ø«</button>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ -->
            <div id="customer-tab" class="tab-content active">
                <h3 class="form-title">ğŸ“‹ Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h3>
                <form id="customerForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="customerName">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„:</label>
                            <input type="text" id="customerName" required>
                        </div>
                        <div class="form-group">
                            <label for="customerRegion">Ø§Ù„Ù…Ù†Ø·Ù‚Ø©:</label>
                            <input type="text" id="customerRegion" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="nearestPoint">Ø£Ù‚Ø±Ø¨ Ù†Ù‚Ø·Ø© Ø¯Ø§Ù„Ø©:</label>
                            <input type="text" id="nearestPoint" required>
                        </div>
                        <div class="form-group">
                            <label for="customerPhone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
                            <input type="tel" id="customerPhone" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="customerDate">Ø§Ù„ØªØ§Ø±ÙŠØ®:</label>
                            <input type="date" id="customerDate" readonly>
                        </div>
                        <div class="form-group">
                            <label for="shiftInfo">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´ÙŠÙØª:</label>
                            <input type="text" id="shiftInfo" readonly>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button type="submit" class="btn btn-success">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                        <button type="button" class="btn btn-danger" onclick="clearCustomerForm()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„</button>
                    </div>
                </form>
                <div id="customerSuccess" class="success-message"></div>
                <div id="customerError" class="error-message"></div>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª -->
            <div id="call-tab" class="tab-content">
                <h3 class="form-title">ğŸ“ ØªØ³Ø¬ÙŠÙ„ Ù…ÙƒØ§Ù„Ù…Ø©</h3>
                <form id="callForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="callType">Ù†ÙˆØ¹ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©:</label>
                            <select id="callType" required>
                                <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©</option>
                                <option value="Ø§Ø³ØªÙØ³Ø§Ø±">Ø§Ø³ØªÙØ³Ø§Ø±</option>
                                <option value="Ø´ÙƒÙˆÙ‰">Ø´ÙƒÙˆÙ‰</option>
                                <option value="Ø¶Ø¹Ù Ø¨Ø§Ù„Ø®Ø¯Ù…Ø©">Ø¶Ø¹Ù Ø¨Ø§Ù„Ø®Ø¯Ù…Ø©</option>
                                <option value="Ø·Ù„Ø¨ Ø§Ø´ØªØ±Ø§Ùƒ">Ø·Ù„Ø¨ Ø§Ø´ØªØ±Ø§Ùƒ</option>
                                <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="callPhone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
                            <input type="tel" id="callPhone" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="callerName">Ø§Ø³Ù… Ø§Ù„Ù…ØªØµÙ„:</label>
                            <input type="text" id="callerName" required>
                        </div>
                        <div class="form-group">
                            <label for="callShift">Ø§Ù„Ø´ÙŠÙØª ÙˆØ§Ù„ÙˆÙ‚Øª:</label>
                            <input type="text" id="callShift" readonly>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="callDetails">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©:</label>
                        <textarea id="callDetails" required placeholder="Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©..."></textarea>
                    </div>
                    <div class="btn-group">
                        <button type="submit" class="btn btn-success">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©</button>
                        <button type="button" class="btn btn-danger" onclick="clearCallForm()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„</button>
                    </div>
                </form>
                <div id="callSuccess" class="success-message"></div>
                <div id="callError" class="error-message"></div>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¨Ø­Ø« -->
            <div id="search-tab" class="tab-content">
                <h3 class="form-title">ğŸ” Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                <div class="form-group">
                    <label for="searchQuery">Ø§Ù„Ø¨Ø­Ø«:</label>
                    <input type="text" id="searchQuery" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…ØŒ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙØŒ Ø£Ùˆ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©...">
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="searchData()">ğŸ” Ø¨Ø­Ø«</button>
                </div>
                <div id="searchResults" class="search-results"></div>
                
                <!-- Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© -->
                <div id="selectedResult" style="display: none; margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <h4>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯:</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ø§Ù„Ø§Ø³Ù…:</label>
                            <input type="text" id="selectedName" readonly>
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©:</label>
                            <input type="text" id="selectedRegion" readonly>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ø£Ù‚Ø±Ø¨ Ù†Ù‚Ø·Ø© Ø¯Ø§Ù„Ø©:</label>
                            <input type="text" id="selectedPoint" readonly>
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ù‡Ø§ØªÙ:</label>
                            <input type="text" id="selectedPhone" readonly>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ø§Ù„ØªØ§Ø±ÙŠØ®:</label>
                            <input type="text" id="selectedDate" readonly>
                        </div>
                        <div class="form-group">
                            <label>Ø§Ù„Ù…ÙˆØ¸Ù:</label>
                            <input type="text" id="selectedEmployee" readonly>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</label>
                        <textarea id="selectedNotes" readonly></textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø«Ø§Ø¨ØªØ© -->
    <div id="clock" class="clock">â° Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    <div id="employeeInfo" class="employee-info">ğŸ‘¤ Ù…Ø±Ø­Ø¨Ø§Ù‹</div>
    <button id="switchUserBtn" class="switch-user-btn" onclick="switchUser()" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">ğŸ”„</button>

    <script>
        // Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø©
        let loggedInUser = '';
        let clockInterval;

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ©)
        const users = {
            'Ø­Ø³ÙŠÙ† Ø­ÙŠØ¯Ø±': '1',
            'Ø¹Ù„ÙŠ Ù…Ø­Ù…ÙˆØ¯': '1',
            'Ø¹Ù„ÙŠ ÙØ§Ù‡Ù…': '1',
            'Ù…ØµØ·ÙÙ‰ Ø³Ø¹Ø¯': '1',
            'ÙŠÙˆØ³Ù Ø¹Ø¨Ø§Ø³': '1',
            'ÙƒØ±Ø§Ø± ÙƒØ±ÙŠÙ…': '1',
            'ØªÙ…ÙŠÙ… Ø­Ø³Ø§Ù†': '1'
        };

        // Ø±ÙˆØ§Ø¨Ø· Google Apps Script
        const CUSTOMER_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwSLbtvvOds77qpByrLiCIhDk4W0lJg-M3nlZjo9TnNKx4PJgp94inO35g4q2FBZbAp5w/exec';
        const CALL_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzR2R0gxIwa5jnlpdY_FrIS6tmsBDPLRm4Akgd5feqOlFjZbVC1CXwxQh5e9bM0Lp2ong/exec';
        const SEARCH_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyIXpdM3fJqQIiWJp3o65b5ypXYGoFqOJlb_5x7uyuB/dev';

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.onload = function() {
            initializeApp();
        };

        function initializeApp() {
            updateDateTime();
            startClock();
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
            document.getElementById('customerForm').addEventListener('submit', handleCustomerSubmit);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª
            document.getElementById('callForm').addEventListener('submit', handleCallSubmit);

            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ù„Ø¨Ø­Ø« Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
            document.getElementById('searchQuery').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchData();
                }
            });
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            const errorDiv = document.getElementById('loginError');

            if (!username || !password) {
                showMessage(errorDiv, 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±', false);
                return;
            }

            if (users[username] && users[username] === password) {
                loggedInUser = username;
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('mainInterface').style.display = 'block';
                document.getElementById('employeeInfo').innerHTML = `ğŸ‘¤ ${loggedInUser}`;
                showMessage(errorDiv, 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!', true);
                setTimeout(() => {
                    errorDiv.style.display = 'none';
                }, 2000);
            } else {
                showMessage(errorDiv, 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©', false);
            }
        }

        // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function switchUser() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ÙˆØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ')) {
                loggedInUser = '';
                document.getElementById('loginForm').style.display = 'block';
                document.getElementById('mainInterface').style.display = 'none';
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                clearAllForms();
            }
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        function closeApp() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ØŸ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ø³ØªÙÙ‚Ø¯.')) {
                window.close();
            }
        }

        // Ø¹Ø±Ø¶ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        function showTab(tabId) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));

            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ø¯Ø¯
            document.querySelector(`[onclick="showTab('${tabId}')"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„ØªØ§Ø±ÙŠØ®
        function updateDateTime() {
            const now = new Date();
            const date = now.toLocaleDateString('ar-SA');
            const time = now.toLocaleTimeString('ar-SA', { 
                hour12: true, 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit' 
            });
            
            const shift = getCurrentShift();
            
            document.getElementById('customerDate').value = now.toISOString().split('T')[0];
            document.getElementById('shiftInfo').value = `${shift} - ${loggedInUser} - ${time}`;
            document.getElementById('callShift').value = `${shift} - ${time}`;
            document.getElementById('clock').innerHTML = `â° ${time}`;
        }

        // Ø¨Ø¯Ø¡ Ø³Ø§Ø¹Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ«
        function startClock() {
            updateDateTime();
            clockInterval = setInterval(updateDateTime, 1000);
        }

        // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø´ÙŠÙØª Ø§Ù„Ø­Ø§Ù„ÙŠ
        function getCurrentShift() {
            const hour = new Date().getHours();
            if (hour >= 6 && hour < 15) {
                return 'Ø§Ù„Ø´ÙŠÙØª Ø§Ù„ØµØ¨Ø§Ø­ÙŠ';
            } else if (hour >= 15 && hour < 22) {
                return 'Ø§Ù„Ø´ÙŠÙØª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠ';
            } else {
                return 'Ø§Ù„Ø´ÙŠÙØª Ø§Ù„Ù„ÙŠÙ„ÙŠ';
            }
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø±Ø³Ø§Ù„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
        async function handleCustomerSubmit(e) {
            e.preventDefault();
            
            const formData = {
                username: document.getElementById('customerName').value.trim(),
                region: document.getElementById('customerRegion').value.trim(),
                closestPoint: document.getElementById('nearestPoint').value.trim(),
                phone: document.getElementById('customerPhone').value.trim(),
                date: document.getElementById('customerDate').value,
                notes: document.getElementById('shiftInfo').value,
                employee: loggedInUser
            };

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (!formData.username || !formData.region || !formData.closestPoint || !formData.phone) {
                showMessage(document.getElementById('customerError'), 'ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', false);
                return;
            }

            try {
                const response = await fetch(CUSTOMER_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    showMessage(document.getElementById('customerSuccess'), 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Google Sheet Ø¨Ù†Ø¬Ø§Ø­', true);
                    clearCustomerForm();
                } else {
                    throw new Error(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ${response.status}`);
                }
            } catch (error) {
                showMessage(document.getElementById('customerError'), `Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸: ${error.message}`, false);
            }
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø±Ø³Ø§Ù„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª
        async function handleCallSubmit(e) {
            e.preventDefault();
            
            const formData = {
                call_type: document.getElementById("callType").value,
                phone: document.getElementById("callPhone").value.trim(),
                caller_name: document.getElementById("callerName").value.trim(),
                shift_time: document.getElementById("callShift").value,
                details: document.getElementById("callDetails").value.trim(),
                employee: loggedInUser
            };

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (!formData.call_type || !formData.phone || !formData.caller_name || !formData.details) {
                showMessage(document.getElementById("callError"), "ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©", false);
                return;
            }

            try {
                const response = await fetch(CALL_SCRIPT_URL, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    showMessage(document.getElementById("callSuccess"), "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© Ø¥Ù„Ù‰ Google Sheet Ø¨Ù†Ø¬Ø§Ø­", true);
                    clearCallForm();
                } else {
                    throw new Error(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ${response.status}`);
                }
            } catch (error) {
                showMessage(document.getElementById("callError"), `Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸: ${error.message}`, false);
            }
        }

        // Ù…Ø³Ø­ Ø­Ù‚ÙˆÙ„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
        function clearCustomerForm() {
            document.getElementById("customerName").value = "";
            document.getElementById("customerRegion").value = "";
            document.getElementById("nearestPoint").value = "";
            document.getElementById("customerPhone").value = "";
            updateDateTime(); // Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„Ø´ÙŠÙØª
        }

        // Ù…Ø³Ø­ Ø­Ù‚ÙˆÙ„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø§Øª
        function clearCallForm() {
            document.getElementById("callType").value = "";
            document.getElementById("callPhone").value = "";
            document.getElementById("callerName").value = "";
            document.getElementById("callDetails").value = "";
            updateDateTime(); // Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´ÙŠÙØª ÙˆØ§Ù„ÙˆÙ‚Øª
        }

        // Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
        function clearAllForms() {
            clearCustomerForm();
            clearCallForm();
            document.getElementById("searchQuery").value = "";
            document.getElementById("searchResults").innerHTML = "";
            document.getElementById("selectedResult").style.display = "none";
        }

        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­/Ø§Ù„Ø®Ø·Ø£
        function showMessage(element, message, isSuccess) {
            element.textContent = message;
            element.className = isSuccess ? "success-message" : "error-message";
            element.style.display = "block";
            setTimeout(() => {
                element.style.display = "none";
            }, 3000);
        }

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« (ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥ÙƒÙ…Ø§Ù„)
        async function searchData() {
            const query = document.getElementById("searchQuery").value.trim();
            const searchResultsDiv = document.getElementById("searchResults");
            searchResultsDiv.innerHTML = ""; // Ù…Ø³Ø­ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            document.getElementById("selectedResult").style.display = "none";

            if (!query) {
                searchResultsDiv.innerHTML = "<p style=\"text-align: center; color: #dc3545;\">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ù„Ù„Ø¨Ø­Ø«.</p>";
                return;
            }

            searchResultsDiv.innerHTML = "<p style=\"text-align: center; color: #6c757d;\">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...</p>";

            try {
                const response = await fetch(`${SEARCH_SCRIPT_URL}?query=${encodeURIComponent(query)}`);
                const data = await response.json();

                if (data.length > 0) {
                    data.forEach(item => {
                        const resultItem = document.createElement("div");
                        resultItem.classList.add("result-item");
                        resultItem.innerHTML = `<strong>${item.Name}</strong> - ${item.Phone} - ${item.Region}`;
                        resultItem.onclick = () => displaySelectedResult(item);
                        searchResultsDiv.appendChild(resultItem);
                    });
                } else {
                    searchResultsDiv.innerHTML = "<p style=\"text-align: center; color: #6c757d;\">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©.</p>";
                }
            } catch (error) {
                searchResultsDiv.innerHTML = `<p style=\"text-align: center; color: #dc3545;\">Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø«: ${error.message}</p>`;
            }
        }

        // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
        function displaySelectedResult(item) {
            document.getElementById("selectedName").value = item.Name || "";
            document.getElementById("selectedRegion").value = item.Region || "";
            document.getElementById("selectedPoint").value = item.ClosestPoint || "";
            document.getElementById("selectedPhone").value = item.Phone || "";
            document.getElementById("selectedDate").value = item.Date || "";
            document.getElementById("selectedEmployee").value = item.Employee || "";
            document.getElementById("selectedNotes").value = item.Notes || "";
            document.getElementById("selectedResult").style.display = "block";
        }

    </script>
</body>
</html>

